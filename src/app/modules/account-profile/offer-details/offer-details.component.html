<div class="container mt-4">
  <h3>تفاصيل العرض</h3>
  <button class="btn btn-secondary mb-3" (click)="goBack()">رجوع</button>
  <div *ngIf="isLoading" class="alert alert-info">جاري تحميل تفاصيل العرض...</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
  <div *ngIf="offer" class="offer-details">
    <div class="card">
      <div class="card-header">
        <div class="d-flex justify-content-between align-items-start">
          <h5>عرض رقم #{{ offer.ID }}</h5>
          <span class="status-badge status-{{ offer.OfferStatus }}">
            {{
              offer.OfferStatus === 'Pending' ? 'قيد الانتظار' :
              offer.OfferStatus === 'OnWay' ? 'في الطريق' :
              offer.OfferStatus === 'Delivered' ? 'تم التسليم' :
              offer.OfferStatus === 'InProgress' ? 'قيد التنفيذ' :
              offer.OfferStatus === 'Completed' ? 'مكتمل' :
              offer.OfferStatus === 'Canceled' ? 'ملغي' :
              offer.OfferStatus
            }}
          </span>
        </div>
        <small class="text-muted">بتاريخ: {{ offer.CreatedAt | date:'short' }}</small>
      </div>
      <div class="card-body">

        <p class="text-muted">{{ offer.Description }}</p>
        <div class="row">
          <div class="col-md-6">
            <p><strong>السعر:</strong> {{ offer.Price }} جنيه</p>
            <p><strong>الفئة:</strong> {{ offer.Category }}</p>
            <p><strong>الوزن:</strong> {{ offer.Weight }} كجم</p>
            <p><strong>قابل للكسر:</strong> {{ offer.IsBreakable ? 'نعم' : 'لا' }}</p>
          </div>
          <div class="col-md-6">
            <p><strong>محطة الاستلام:</strong> {{ offer.PickupStationName }}</p>
            <p><strong>محطة التسليم:</strong> {{ offer.DropoffStationName }}</p>
            <p><strong>طريقة الدفع:</strong> {{ getPaymentMethodLabel(offer.PaymentMethod) }}</p>
            <p><strong>آخر تحديث:</strong> {{ offer.LastUpdate | date:'short' }}</p>
          </div>
        </div>
        <div *ngIf="offer.Picture" class="mt-3">
          <img [src]="offer.Picture" alt="صورة العرض" class="img-fluid" style="max-width: 300px;">
        </div>
      </div>
    </div>
    <div class="requests-section mt-4">
      <h5>الطلبات المرتبطة ({{ offer.RequestsCount }} طلب)</h5>
      <div *ngIf="offer.Requests?.length; else noRequests">
        <div *ngFor="let request of offer.Requests" class="request-card mb-2">
          <div class="d-flex justify-content-between align-items-start">
            <span>طلب رقم #{{ request.Id }}</span>
            <small class="text-muted">بواسطة: {{ request.CourierId }}</small>
          </div>
          <p class="text-muted small mb-1">{{ request.Message }}</p>
          <small class="text-muted">بتاريخ: {{ request.ReqTime }}</small>
        </div>
      </div>
      <ng-template #noRequests>
        <p class="text-muted">لا توجد طلبات مرتبطة بهذا العرض.</p>
      </ng-template>
    </div>
  </div>
</div>